.ops .copilot-overlay{ position:fixed; inset:0; height:100vh; height:100dvh; background:rgba(8,12,22,0.92); -webkit-backdrop-filter: blur(6px); backdrop-filter: blur(6px); display:grid; grid-template-columns:280px 1fr; z-index:100; }
.ops[data-theme='light'] .copilot-overlay{ background:rgba(255,255,255,0.92); }
.ops .copilot-sidebar{ border-right:1px solid var(--ops-border); background:var(--ops-blue-2); display:flex; flex-direction:column; }
.ops[data-theme='light'] .copilot-sidebar{ background:#f8fafc; }
.ops .copilot-sidebar .top{ display:flex; align-items:center; justify-content:space-between; padding:14px 12px; border-bottom:1px solid var(--ops-border); }
.ops .copilot-list{ flex:1; overflow-y:auto; overflow-x:hidden; padding:8px; display:grid; gap:6px; align-content:start; grid-auto-rows:min-content; }
.ops .copilot-list .list-item{ width:100%; text-align:left; padding:10px 8px 10px 12px; background:transparent; border:1px solid transparent; border-radius:10px; color:var(--ops-text); min-width:0; }
.ops .copilot-list .list-item:hover{ background:var(--ops-blue-3); border-color:var(--ops-border); }
.ops .copilot-list .list-item.active{ background:var(--ops-blue-3); border-color:var(--ops-border); }
.ops[data-theme='light'] .copilot-list .list-item:hover{ background:#eef2ff; border-color:#c7d2fe; }
.ops[data-theme='light'] .copilot-list .list-item.active{ background:#eaf1ff; border-color:#c7d2fe; color:#0f172a; }
.ops .copilot-list .copilot-excerpt{ display:block; font-size:12px; color:var(--ops-muted); white-space:nowrap; overflow:hidden; text-overflow:ellipsis; width:36ch; max-width:100%; }
@media (max-width: 720px){ .ops .copilot-list .copilot-excerpt{ width:28ch; } }
.ops .copilot-main{ display:grid; grid-template-rows:auto 1fr auto; min-height:0; }
.ops .copilot-main .bar{ display:flex; align-items:center; justify-content:space-between; padding:12px 16px; border-bottom:1px solid var(--ops-border); }
.ops .copilot-main .bar .copilot-min{ width:40px; height:40px; display:inline-flex; align-items:center; justify-content:center; border-radius:12px; background:#1b2a52; border:1px solid #27407a; color:#dfe8ff; cursor:pointer; box-shadow: 0 4px 14px rgba(0,0,0,0.25); transition: transform .12s ease, filter .12s ease, background .12s ease, border-color .12s ease; }
.ops .copilot-main .bar .copilot-min:hover{ filter: brightness(1.06); transform: translateY(-1px); }
.ops .copilot-main .bar .copilot-min:active{ transform: translateY(0); }
.ops .copilot-main .bar .copilot-min svg{ pointer-events:none; }
.ops[data-theme='light'] .copilot-main .bar .copilot-min{ background:#eef2ff; border:1px solid #c7d2fe; color:#1e293b; }
.ops[data-theme='light'] .copilot-main .bar .copilot-min:hover{ background:#e5e9ff; }
.ops .messages{ padding:16px; overflow:auto; display:flex; flex-direction:column; gap:14px; min-height:0; max-height:100%; overscroll-behavior:contain; padding-bottom: calc(var(--copilot-inpb, 72px) + 16px); scroll-padding-bottom: calc(var(--copilot-inpb, 72px) + 16px); }
.ops .msg{ display:grid; gap:8px; background:var(--ops-blue-2); border:1px solid var(--ops-border); border-radius:12px; padding:12px 14px; max-width:720px; word-break:break-word; line-height:1.6; }
.ops .msg.me{ background:#18233d; border-color:#22315a; align-self:flex-end; margin-left:0; }
.ops[data-theme='light'] .msg.me{ background:#eef2ff; border-color:#c7d2fe; }
.ops[data-theme='light'] .msg{ background:#ffffff; border-color:#e2e8f0; }
.ops .input-bar{ display:grid; grid-template-columns:1fr auto; gap:8px; padding:12px; border-top:1px solid var(--ops-border); background:var(--ops-blue-2); }
.ops .input{ width:100%; background:var(--ops-blue-3); color: var(--ops-text); border:1px solid var(--ops-border); border-radius:10px; padding:10px 12px; }
.ops[data-theme='light'] .input-bar{ background:#ffffff; }
.ops[data-theme='light'] .input{ background:#f8fafc; border-color:#e2e8f0; color:#0f172a; }
@media (max-width: 960px){ .ops .copilot-overlay{ grid-template-columns:1fr; } .ops .copilot-sidebar{ display:none; } }

/* Mobile refinements */
@media (max-width: 720px){
  .ops .messages{ padding:12px; gap:10px; }
  .ops .input{ padding:12px; min-height:40px; }
  .ops .copilot-main .bar{ padding:10px 12px; }
  .ops .input-bar{
    position: sticky;
    bottom: 0;
    padding: 10px 12px calc(10px + env(safe-area-inset-bottom));
    z-index: 2;
    backdrop-filter: blur(6px);
    -webkit-backdrop-filter: blur(6px);
  }
  .ops .copilot-main .bar .copilot-menu{ display:inline-flex; align-items:center; justify-content:center; width:36px; height:36px; border-radius:8px; background:transparent; border:1px solid var(--ops-border); color:var(--ops-text); }
}

/* Off-canvas drawer for chats (mobile) */
.ops .copilot-scrim{ position:fixed; inset:0; background:rgba(0,0,0,0.3); opacity:0; pointer-events:none; transition: opacity .18s ease; z-index: 101; }
.ops .copilot-scrim.open{ opacity:1; pointer-events:auto; }
.ops .copilot-drawer{ position:fixed; top:0; left:0; bottom:0; width:84%; max-width:360px; background:var(--ops-blue-2); border-right:1px solid var(--ops-border); transform: translateX(-100%); transition: transform .22s ease; z-index: 102; display:flex; flex-direction:column; }
.ops[data-theme='light'] .copilot-drawer{ background:#f8fafc; }
.ops .copilot-drawer.open{ transform: translateX(0); }
.ops .copilot-drawer .drawer-head{ display:flex; align-items:center; justify-content:space-between; padding:12px; border-bottom:1px solid var(--ops-border); }

/* Typing dots */
.ops .typing{ display:inline-flex; gap:6px; align-items:center; height:1em; }
.ops .typing .dot{ width:6px; height:6px; border-radius:50%; background: currentColor; opacity:0.35; animation: gl-typing 1.2s infinite ease-in-out; }
.ops .typing .dot:nth-child(2){ animation-delay: 0.15s; }
.ops .typing .dot:nth-child(3){ animation-delay: 0.3s; }
@keyframes gl-typing{
  0%, 80%, 100% { opacity: 0.35; transform: translateY(0); }
  40% { opacity: 1; transform: translateY(-2px); }
}

/* Markdown within assistant messages */
.ops .msg .md{ display:grid; gap:8px; line-height:1.75; }
.ops .msg .md p{ margin:0; }
.ops .msg .md h1,
.ops .msg .md h2,
.ops .msg .md h3{ margin:6px 0 2px; line-height:1.3; }
.ops .msg .md h1{ font-size:1.2em; }
.ops .msg .md h2{ font-size:1.15em; }
.ops .msg .md h3{ font-size:1.08em; }
.ops .msg .md ul,
.ops .msg .md ol{ margin:0; padding-left:20px; }
.ops .msg .md li{ margin:0 0 6px; }
.ops .msg .md a{ text-decoration: underline; }

/* Sleek minimize icon button */
.ops .copilot-min{ width:40px; height:40px; display:inline-flex; align-items:center; justify-content:center; border-radius:12px; background:#1b2a52; border:1px solid #27407a; color:#dfe8ff; cursor:pointer; box-shadow: 0 4px 14px rgba(0,0,0,0.25); transition: transform .12s ease, filter .12s ease, background .12s ease, border-color .12s ease; }
.ops .copilot-min:hover{ filter: brightness(1.06); transform: translateY(-1px); }
.ops .copilot-min:active{ transform: translateY(0); }
.ops .copilot-min svg{ pointer-events:none; }
.ops[data-theme='light'] .copilot-min{ background:#eef2ff; border:1px solid #c7d2fe; color:#1e293b; }
.ops[data-theme='light'] .copilot-min:hover{ background:#e5e9ff; }

/* Compact icon buttons (used for Trash etc.) */
.ops .icon-btn{ width:28px; height:28px; display:inline-flex; align-items:center; justify-content:center; border-radius:8px; border:none; background:transparent; color:var(--ops-text); cursor:pointer; transition: color .12s ease, filter .12s ease; }
.ops .icon-btn:hover{ background: transparent; }
.ops .icon-btn:active{ filter: brightness(1.05); }
.ops[data-theme='light'] .icon-btn:hover{ background: transparent; }
.ops .icon-btn.danger:hover{ background: transparent; color:#ef4444; }
.ops .icon-btn.danger:active{ background: transparent; color:#ef4444; }
/* Ensure no UA/override background sneaks in */
.ops .icon-btn,
.ops .icon-btn:hover,
.ops .icon-btn:focus,
.ops .icon-btn:focus-visible,
.ops .icon-btn:active{ background: transparent !important; box-shadow: none !important; }
